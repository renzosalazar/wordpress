<?xml version="1.0" encoding="UTF-8"?>
<!-- This is a code snippets export file generated by the Code Snippets WordPress plugin. -->
<!-- https://wordpress.org/plugins/code-snippets -->
<!-- To import these snippets a WordPress site follow these steps: -->
<!-- 1. Log in to that site as an administrator. -->
<!-- 2. Install the Code Snippets plugin using the directions provided at the above link. -->
<!-- 3. Go to 'Tools: Import' in the WordPress admin panel. -->
<!-- 4. Click on the "Code Snippets" importer in the list -->
<!-- 5. Upload this file using the form provided on that page. -->
<!-- 6. Code Snippets will then import all of the snippets and associated information contained in this file into your site. -->
<!-- 7. You will then have to visit the 'Snippets: All Snippets' admin menu and activate desired snippets. -->
<!-- generator="Code Snippets/2.9.4" created="2017-10-06 20:05" -->
<snippets>
  <snippet scope="1">
    <name>Search customers with numeric usernames in WooCommerce</name>
    <desc></desc>
    <tags>search, customers, numeric, woocommerce</tags>
    <code>add_action( 'wp_ajax_woocommerce_json_search_customers', 'wc_search_customers', 5 );&#13;
&#13;
function wc_search_customers() {&#13;
ob_start();&#13;
&#13;
	check_ajax_referer( 'search-customers', 'security' );&#13;
&#13;
	if ( ! current_user_can( 'edit_shop_orders' ) ) {&#13;
		die(-1);&#13;
	}&#13;
&#13;
	$term    = wc_clean( stripslashes( $_GET['term'] ) );&#13;
	$exclude = array();&#13;
&#13;
	if ( empty( $term ) ) {&#13;
		die();&#13;
	}&#13;
&#13;
	if ( ! empty( $_GET['exclude'] ) ) {&#13;
		$exclude = array_map( 'intval', explode( ',', $_GET['exclude'] ) );&#13;
	}&#13;
&#13;
	$found_customers = array();&#13;
&#13;
&#13;
	$customers_query = new WP_User_Query( apply_filters( 'woocommerce_json_search_customers_query', array(&#13;
		'fields'         =&gt; 'all',&#13;
		'orderby'        =&gt; 'display_name',&#13;
		'search'         =&gt; '*' . $term . '*',&#13;
		'search_columns' =&gt; array( 'ID', 'user_login', 'user_email', 'user_nicename' )&#13;
	) ) );&#13;
&#13;
error_log( print_r( $customers_query, true ) );&#13;
	$customers = $customers_query-&gt;get_results();&#13;
&#13;
	if ( ! empty( $customers ) ) {&#13;
		foreach ( $customers as $customer ) {&#13;
			if ( ! in_array( $customer-&gt;ID, $exclude ) ) {&#13;
				$found_customers[ $customer-&gt;ID ] = $customer-&gt;display_name . ' (#' . $customer-&gt;ID . ' &amp;ndash; ' . sanitize_email( $customer-&gt;user_email ) . ')';&#13;
			}&#13;
		}&#13;
	}&#13;
&#13;
	$found_customers = apply_filters( 'woocommerce_json_search_found_customers', $found_customers );&#13;
&#13;
	wp_send_json( $found_customers );&#13;
}</code>
  </snippet>
</snippets>
